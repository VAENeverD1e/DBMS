music_streaming_api/
â”œâ”€â”€ run.py               # ğŸš€ File Ä‘á»ƒ CHáº Y á»©ng dá»¥ng (entry point)
â”œâ”€â”€ config.py            # ğŸ”§ Lá»›p Config (Dev, Prod, Test), chá»©a SECRET_KEY, DATABASE_URI
â”œâ”€â”€ requirements.txt     # ğŸ“¦ Danh sÃ¡ch thÆ° viá»‡n (Flask, SQLAlchemy, Marshmallow, JWT...)
â”œâ”€â”€ .env                 # ğŸ¤« Biáº¿n mÃ´i trÆ°á»ng Báº¢O Máº¬T (DB_USER, DB_PASSWORD)
â”œâ”€â”€ .env.example         # (File máº«u cá»§a .env)
â”‚
â””â”€â”€ app/                 #  CORE: Package chÃ­nh cá»§a á»©ng dá»¥ng
    â”‚
    â”œâ”€â”€ __init__.py        # ğŸ­ HÃ m "Application Factory" - create_app()
    â”œâ”€â”€ models.py          # ğŸ›ï¸ (Entities) Táº¤T Cáº¢ models (User+Role, Artwork, Song, Reaction, Follow, Plan...)
    â”œâ”€â”€ extensions.py      # ğŸ”— Khá»Ÿi táº¡o cÃ¡c extensions (db, ma, jwt, migrate)
    â”œâ”€â”€ exceptions.py      # âš ï¸ CÃ¡c class Exception tÃ¹y chá»‰nh (chung)
    â”‚
    â”œâ”€â”€ utils/               # ğŸ› ï¸ (Utilities)
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ decorators.py  # ğŸ›¡ï¸ NÆ¡i chá»©a @listener_required, @artist_required, @premium_required
    â”‚   â””â”€â”€ common.py      # CÃ¡c hÃ m tiá»‡n Ã­ch dÃ¹ng chung
    â”‚
    â”œâ”€â”€ auth/              # --- ğŸ”‘ MODULE AUTH ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /register, /login, /refresh_token
    â”‚   â”œâ”€â”€ services.py    # (Service) Logic hash password, táº¡o JWT
    â”‚   â””â”€â”€ schemas.py     # (DTO) RegisterSchema, LoginSchema
    â”‚
    â”œâ”€â”€ users/             # --- ğŸ‘¤ MODULE USERS (RIÃŠNG TÆ¯) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /me, /me/following, /me/liked-songs
    â”‚   â”œâ”€â”€ services.py
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â”œâ”€â”€ artists/           # --- ğŸ¤ MODULE ARTISTS (CÃ”NG KHAI) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /artists, /artists/<id>, /artists/<id>/follow
    â”‚   â”œâ”€â”€ services.py
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â”œâ”€â”€ artworks/          # --- ğŸ¨ MODULE ARTWORKS (Gá»˜P ALBUM/SINGLE) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /artworks, /artworks/<id>, /artworks/<id>/songs
    â”‚   â”œâ”€â”€ services.py    # (Service) Logic táº¡o artwork (cáº§n @artist_required)
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â”œâ”€â”€ songs/             # --- ğŸµ MODULE SONGS ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /songs/<id>, /songs/<id>/stream, /songs/<id>/lyrics
    â”‚   â”œâ”€â”€ services.py    # (Service) Logic táº¡o pre-signed URL (S3)
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â”œâ”€â”€ playlists/         # --- ğŸ¶ MODULE PLAYLISTS ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) /playlists (cáº§n @listener_required)
    â”‚   â”œâ”€â”€ services.py
    â”‚   â”œâ”€â”€ schemas.py
    â”‚   â””â”€â”€ exceptions.py  # (Exceptions) PlaylistPermissionError
    â”‚
    â”œâ”€â”€ reactions/         # --- â¤ï¸ MODULE REACTIONS (ÄA HÃŒNH) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) POST /reactions (cáº§n @listener_required)
    â”‚   â”œâ”€â”€ services.py    # (Service) Logic "react" Ä‘a hÃ¬nh
    â”‚   â””â”€â”€ schemas.py     # (DTO) ReactionSchema (chá»©a reactable_type, reactable_id)
    â”‚
    â”œâ”€â”€ plans/             # --- ğŸ“ˆ MODULE PLANS (SUBSCRIPTION) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) GET /plans (láº¥y danh sÃ¡ch gÃ³i)
    â”‚   â”œâ”€â”€ services.py
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â”œâ”€â”€ payments/          # --- ğŸ’³ MODULE PAYMENTS (SUBSCRIPTION) ---
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ routes.py      # (Controller) POST /create-checkout-session, POST /webhook
    â”‚   â”œâ”€â”€ services.py    # (Service) Logic gá»i Stripe/Momo, xá»­ lÃ½ webhook
    â”‚   â””â”€â”€ schemas.py
    â”‚
    â””â”€â”€ subscriptions/     # --- ğŸ‘‘ MODULE SUBSCRIPTIONS (TRáº NG THÃI) ---
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ routes.py      # (Controller) GET /subscriptions/me, POST /subscriptions/cancel
        â”œâ”€â”€ services.py    # (Service) Logic kiá»ƒm tra tráº¡ng thÃ¡i, há»§y gia háº¡n
        â””â”€â”€ schemas.py